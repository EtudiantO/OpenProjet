
import os
import csv
from bs4 import BeautifulSoup
import requests
import shutil

#path = os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Fichiers/fille.csv:")
#result = os.listdir(p"ath)"

#def get_all_categories():
   # book_cat = "https://books.toscrape.com/catalogue/category/books_1/index.html"
   # reponse = requests.get(book_cat)
   # soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

#with open( os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Fichiers/fille.csv"), 'w', newline='') as fs:
        #writer = csv.writer(fs)
       # writer.writerows("005, ORANGE,INERTMILAN,38")
def get_all_categories():
    book = ["https://books.toscrape.com/catalogue/category/books_1/index.html","https://books.toscrape.com/catalogue/category/books_1/page-2.html","https://books.toscrape.com/catalogue/category/books_1/page-3.html","https://books.toscrape.com/catalogue/category/books_1/page-4.html",
            "https://books.toscrape.com/catalogue/category/books_1/page-5.html","https://books.toscrape.com/catalogue/category/books_1/page-6.html","https://books.toscrape.com/catalogue/category/books_1/page-7.html","https://books.toscrape.com/catalogue/category/books_1/page-8.html","https://books.toscrape.com/catalogue/category/books_1/page-9.html","https://books.toscrape.com/catalogue/category/books_1/page-10.html","https://books.toscrape.com/catalogue/category/books_1/page-11.html","https://books.toscrape.com/catalogue/category/books_1/page-12.html","https://books.toscrape.com/catalogue/category/books_1/page-13.html","https://books.toscrape.com/catalogue/category/books_1/page-14.html","https://books.toscrape.com/catalogue/category/books_1/page-15.html","https://books.toscrape.com/catalogue/category/books_1/page-16.html","https://books.toscrape.com/catalogue/category/books_1/page-17.html","https://books.toscrape.com/catalogue/category/books_1/page-18.html","https://books.toscrape.com/catalogue/category/books_1/page-19.html","https://books.toscrape.com/catalogue/category/books/short-stories_45/index.html"
            "https://books.toscrape.com/catalogue/category/books_1/page-20.html","https://books.toscrape.com/catalogue/category/books_1/page-21.html","https://books.toscrape.com/catalogue/category/books_1/page-22.html","https://books.toscrape.com/catalogue/category/books_1/page-23.html","https://books.toscrape.com/catalogue/category/books_1/page-24.html","https://books.toscrape.com/catalogue/category/books_1/page-25.html","https://books.toscrape.com/catalogue/category/books_1/page-26.html","https://books.toscrape.com/catalogue/category/books_1/page-27.html","https://books.toscrape.com/catalogue/category/books_1/page-28.html","https://books.toscrape.com/catalogue/category/books_1/page-29.html","https://books.toscrape.com/catalogue/category/books_1/page-30.html","https://books.toscrape.com/catalogue/category/books_1/page-31.html","https://books.toscrape.com/catalogue/category/books_1/page-32.html","https://books.toscrape.com/catalogue/category/books_1/page-33.html","https://books.toscrape.com/catalogue/category/books_1/page-34.html","https://books.toscrape.com/catalogue/category/books_1/page-35.html",
            "https://books.toscrape.com/catalogue/category/books_1/page-36.html","https://books.toscrape.com/catalogue/category/books_1/page-37.html","https://books.toscrape.com/catalogue/category/books_1/page-38.html","https://books.toscrape.com/catalogue/category/books_1/page-39.html","https://books.toscrape.com/catalogue/category/books_1/page-40.html","https://books.toscrape.com/catalogue/category/books_1/page-41.html","https://books.toscrape.com/catalogue/category/books_1/page-42.html","https://books.toscrape.com/catalogue/category/books_1/page-43.html","https://books.toscrape.com/catalogue/category/books_1/page-44.html","https://books.toscrape.com/catalogue/category/books_1/page-45.html","https://books.toscrape.com/catalogue/category/books_1/page-46.html","https://books.toscrape.com/catalogue/category/books_1/page-47.html","https://books.toscrape.com/catalogue/category/books_1/page-48.html","https://books.toscrape.com/catalogue/category/books_1/page-49.html","https://books.toscrape.com/catalogue/category/books_1/page-50.html"]
    for book_i in book:
        reponse = requests.get(book_i)
        soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
        elst = []
        if reponse.ok:
            categorie_book = soup.find_all('a')  # afficher les liens de tout categorie livres
            for cat in categorie_book:
                #print(cat['href'])
                elst.append(cat["href"])
            with open( os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Fichiers/fille.csv"), 'w', newline='') as fs:
             writer = csv.writer(fs, delimiter=';', lineterminator='\\n')
             #print(elst)
             writer.writerow(elst)

            with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Fichiers/fille.csv"), newline='', encoding='utf-8') as fs:
                reader = csv.reader(fs)
                for row in reader:
                    print(row)

get_all_categories()

def get_all_books():
    book2=["http://books.toscrape.com/catalogue/category/books/travel_2/index.html","https://books.toscrape.com/catalogue/category/books/mystery_3/index.html","https://books.toscrape.com/catalogue/category/books/historical-fiction_4/index.html","https://books.toscrape.com/catalogue/category/books/sequential-art_5/index.html","https://books.toscrape.com/catalogue/category/books/classics_6/index.html","https://books.toscrape.com/catalogue/category/books/nonfiction_13/index.html","https://books.toscrape.com/catalogue/category/books/thriller_37/index.html","https://books.toscrape.com/catalogue/category/books/contemporary_38/index.html","https://books.toscrape.com/catalogue/category/books/novels_46/index.html",
           "https://books.toscrape.com/catalogue/category/books/philosophy_7/index.html","https://books.toscrape.com/catalogue/category/books/romance_8/index.html","https://books.toscrape.com/catalogue/category/books/womens-fiction_9/index.html","https://books.toscrape.com/catalogue/category/books/fiction_10/index.html","https://books.toscrape.com/catalogue/category/books/childrens_11/index.html","https://books.toscrape.com/catalogue/category/books/religion_12/index.html","https://books.toscrape.com/catalogue/category/books/business_35/index.html","https://books.toscrape.com/catalogue/category/books/self-help_41/index.html","https://books.toscrape.com/catalogue/category/books/health_47/index.html",
           "https://books.toscrape.com/catalogue/category/books/music_14/index.html","https://books.toscrape.com/catalogue/category/books/default_15/index.html","https://books.toscrape.com/catalogue/category/books/science-fiction_16/index.html","https://books.toscrape.com/catalogue/category/books/sports-and-games_17/index.html","https://books.toscrape.com/catalogue/category/books/add-a-comment_18/index.html","https://books.toscrape.com/catalogue/category/books/fantasy_19/index.html","https://books.toscrape.com/catalogue/category/books/new-adult_20/index.html","https://books.toscrape.com/catalogue/category/books/historical_42/index.html","https://books.toscrape.com/catalogue/category/books/politics_48/index.html",
           "https://books.toscrape.com/catalogue/category/books/young-adult_21/index.html","https://books.toscrape.com/catalogue/category/books/poetry_23/index.html","https://books.toscrape.com/catalogue/category/books/science_22/index.html","https://books.toscrape.com/catalogue/category/books/paranormal_24/index.html","https://books.toscrape.com/catalogue/category/books/art_25/index.html","https://books.toscrape.com/catalogue/category/books/humor_30/index.html","https://books.toscrape.com/catalogue/category/books/christian-fiction_34/index.html","https://books.toscrape.com/catalogue/category/books/christian_43/index.html",
           "https://books.toscrape.com/catalogue/category/books/psychology_26/index.html","https://books.toscrape.com/catalogue/category/books/autobiography_27/index.html","https://books.toscrape.com/catalogue/category/books/parenting_28/index.html","https://books.toscrape.com/catalogue/category/books/adult-fiction_29/index.html","https://books.toscrape.com/catalogue/category/books/food-and-drink_33/index.html","https://books.toscrape.com/catalogue/category/books/cultural_49/index.html","https://books.toscrape.com/catalogue/category/books/erotica_50/index.html","https://books.toscrape.com/catalogue/category/books/crime_51/index.html"]
    for bk in book2:
        if bk=="http://books.toscrape.com/catalogue/category/books/travel_2/index.html":
            reponse = requests.get(bk)
            soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

            if reponse.ok:

                list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath(
                        "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/travel.csv"), 'w',   newline='') as ffichier:
                    writer = csv.writer(ffichier, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)

        if bk =="https://books.toscrape.com/catalogue/category/books/historical-fiction_4/index.html":
            reponse = requests.get(bk)
            soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

            if reponse.ok:

                list_book = soup2.find_all("img")# afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/historical-fiction.csv"), 'w', newline='') as ff1:
                 writer = csv.writer(ff1,delimiter=';', lineterminator='\\n')
                 writer.writerow(list)

        if bk=="https://books.toscrape.com/catalogue/category/books/mystery_3/index.html":
                numbre_de_pages = "page 1 of 2"[-1]
                for i in range(1, int(numbre_de_pages)+1):
                    url='https://books.toscrape.com/catalogue/category/books/Mistery_3/page-'+ str(i) +'.html'
                    reponse = requests.get(url)
                    soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                    if reponse.ok:

                        list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                        list = []
                        for image in list_book:
                            list.append(image['src'])

                        with open(os.path.abspath(
                                "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/mystery.csv"), 'w', newline='') as ff2:
                            writer = csv.writer(ff2, delimiter=';', lineterminator='\\n')
                            writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/sequential-art_5/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/sequential-art.csv"),'w', newline='') as ff3:
                        writer = csv.writer(ff3, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/classics_6/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath( "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/classics.csv"),'w', newline='') as ff4:
                        writer = csv.writer(ff4, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/philosophy_7/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/philosophy.csv"), 'w', newline='') as ff5:
                        writer = csv.writer(ff5, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/romance_8/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath(
                            "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/romance.csv"),  'w', newline='') as ff6:
                        writer = csv.writer(ff6, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/womens-fiction_9/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath( "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/womens-fiction.csv"),'w', newline='') as ff7:
                        writer = csv.writer(ff7, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/fiction_10/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath( "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/fiction.csv"), 'w', newline='') as ff8:
                        writer = csv.writer(ff8, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/childrens_11/index.html":
                reponse = requests.get(bk)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/childrens.csv"),'w', newline='') as ff9:
                        writer = csv.writer(ff9, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)

        if bk=="https://books.toscrape.com/catalogue/category/books/religion_12/index.html":
            reponse = requests.get(bk)
            soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

            if reponse.ok:

                list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/religion.csv"),'w', newline='') as file2:
                    writer = csv.writer(file2, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/nonfiction_13/index.html":
            numbre_de_pages = "page 1 of 6"[-1]
            for i in range(1, int(numbre_de_pages) + 1):
                url='https://books.toscrape.com/catalogue/category/books/nonfiction_13/page-'+str(i)+'.html'
                reponse = requests.get(url)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath(
                            "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/nonfiction.csv"), 'w',
                              newline='') as file2:
                        writer = csv.writer(file2, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/music_14/index.html":
            reponse = requests.get(bk)
            soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:

                list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/misic.csv"), 'w',newline='') as file2:
                    writer = csv.writer(file2, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/default_15/index.html":
            numbre_de_pages="page 1 of 8"[-1]
            for i in range(1, int(numbre_de_pages) + 1):
                url='https://books.toscrape.com/catalogue/category/books/default_15/page-'+str(i)+'.html'
                reponse = requests.get(url)
                soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
                if reponse.ok:

                    list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/default.csv"),'w', newline='') as file2:
                        writer = csv.writer(file2, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)

        if bk=="https://books.toscrape.com/catalogue/category/books/science-fiction_16/index.html":
            reponse = requests.get(bk)
            soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:

                list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/science-fiction.csv"),'w', newline='') as file2:
                    writer = csv.writer(file2, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/sports-and-games_17/index.html":
            reponse = requests.get(bk)
            soup2 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:

                list_book = soup2.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/sports-and-games.csv"),'w', newline='') as file02:
                    writer = csv.writer(file02, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/add-a-comment_18/index.html":
            numbre_de_pages="page 1 of 4"[-1]
            for i in range(1, int(numbre_de_pages) +1 ):
                url="https://books.toscrape.com/catalogue/category/books/add-a-comment_18/page-"+str(i)+".html"
                reponse=requests.get(url)
                soup= BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
                if reponse.ok:
                    list_book = soup.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/add-a-comment.csv"), 'w',newline='') as file3:
                        writer = csv.writer(file3, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/fantasy_19/index.html":
            numbre_de_pages="page 1 of 3"[-1]
            for i in range(1, int(numbre_de_pages) + 1 ):
                url="https://books.toscrape.com/catalogue/category/books/fantasy_19/page-"+str(i)+".html"
                reponse = requests.get(url)
                soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
                if reponse.ok:
                    list_book = soup.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/fantasy.csv"), 'w',newline='') as file03:
                        writer = csv.writer(file03, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/new-adult_20/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/new-adult.csv"),'w', newline='') as file3:
                    writer = csv.writer(file3, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/young-adult_21/index.html":
            numbre_de_pages="page 1 of 3"[-1]
            for i in range(1, int(numbre_de_pages) + 1):
                url="https://books.toscrape.com/catalogue/category/books/young-adult_21/page-"+str(i)+".html"
                reponse = requests.get(url)
                soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
                if reponse.ok:
                    list_book = soup.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/young-adult.csv"),'w', newline='') as file3:
                        writer = csv.writer(file3, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)

        if bk=="https://books.toscrape.com/catalogue/category/books/science_22/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/science.csv"), 'w', newline='') as file4:
                    writer = csv.writer(file4, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)

        if bk=="https://books.toscrape.com/catalogue/category/books/poetry_23/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/poetry.csv"),'w', newline='') as file4:
                    writer = csv.writer(file4, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/paranormal_24/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/paranormal.csv"),'w', newline='') as file04:
                    writer = csv.writer(file04, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/art_25/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath(
                        "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/art.csv"), 'w',newline='') as file04:
                    writer = csv.writer(file04, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/psychology_26/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath( "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/psychology.csv"), 'w',newline='') as file04:
                    writer = csv.writer(file04, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/autobiography_27/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath(
                        "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/autobiography.csv"), 'w',
                          newline='') as file04:
                    writer = csv.writer(file04, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/parenting_28/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath(
                        "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/parenting.csv"), 'w',newline='') as file04:
                    writer = csv.writer(file04, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/adult-fiction_29/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath(
                        "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/adult-fiction.csv"), 'w', newline='') as file04:
                    writer = csv.writer(file04, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/humor_30/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath(
                        "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/humor.csv"), 'w', newline='') as file5:
                    writer = csv.writer(file5, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/horror_31/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/horror.csv"), 'w',newline='') as file5:
                    writer = csv.writer(file5, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/history_32/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/history.csv"),
                          'w', newline='') as file5:
                    writer = csv.writer(file5, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/food-and-drink_33/index.html":
            numbre_de_pages="page 1 of 2"[-1]
            for i in range(1, int(numbre_de_pages) + 1):
                url="https://books.toscrape.com/catalogue/category/books/food-and-drink_33/page-"+str(i)+".html"

                reponse = requests.get(url)
                soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
                if reponse.ok:
                    list_book = soup.find_all("img")  # afficher tout les liens images de livres
                    list = []
                    for image in list_book:
                        list.append(image['src'])

                    with open(os.path.abspath(
                            "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/food-and-drink.csv"), 'w',
                              newline='') as file5:
                        writer = csv.writer(file5, delimiter=';', lineterminator='\\n')
                        writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/christian-fiction_34/index.html":

            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath( "C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/christian-fiction.csv"), 'w', newline='') as file5:
                    writer = csv.writer(file5, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/business_35/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/business.csv"), 'w',newline='') as file05:
                    writer = csv.writer(file05, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/biography_36/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(
                        os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/biography.csv"),
                        'w', newline='') as file05:
                    writer = csv.writer(file05, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/thriller_37/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(
                        os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/thriller.csv"),
                        'w', newline='') as file05:
                    writer = csv.writer(file05, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/contemporary_38/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/contemporary.csv"),'w', newline='') as file05:
                    writer = csv.writer(file05, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/spirituality_39/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/contemporary.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/academic_40/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/academic.csv"), 'w',newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/self-help_41/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/self-help.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/historical_42/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(
                        os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/historical.csv"),
                        'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/christian_43/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/christian.csv"), 'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/suspense_44/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/suspense.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/short-stories_45/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/short-stories.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/novels_46/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/novels.csv"), 'w',newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/health_47/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/health.csv"),
                          'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/politics_48/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/politics.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/cultural_49/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/cultural.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/erotica_50/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/erotica.csv"),'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)
        if bk=="https://books.toscrape.com/catalogue/category/books/crime_51/index.html":
            reponse = requests.get(bk)
            soup = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")
            if reponse.ok:
                list_book = soup.find_all("img")  # afficher tout les liens images de livres
                list = []
                for image in list_book:
                    list.append(image['src'])

                with open(
                        os.path.abspath("C:/Users/Idrissa TOUNKARA/PycharmProjects/testProjet/Categorie/crime.csv"),
                        'w', newline='') as file6:
                    writer = csv.writer(file6, delimiter=';', lineterminator='\\n')
                    writer.writerow(list)

get_all_books()

def get_product_page(url_book):

    reponse = requests.get(url_book)
    soup3 = BeautifulSoup(reponse.content.decode("utf-8", "ignore"), features="html.parser")

    if reponse.ok:
        ret={}
        ret['titre']=soup3.find('h1').text
        ret['description'] = soup3.find('meta', {'name': 'description'})['content']
        information = soup3.find_all('td')
        ret['upc_livre'] = information[0].text
        ret['prix_ht'] = information[2].text
        ret['prix_ttc']=information[3].text
        ret['stock']=information[5].text
        for x,y in ret.items():
            print(x,":",y)

get_product_page("https://books.toscrape.com/catalogue/its-only-the-himalayas_981/index.html")
